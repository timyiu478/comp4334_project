(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{211:function(e,t,a){e.exports=a.p+"static/media/logo.25bf045c.svg"},228:function(e,t,a){e.exports=a(348)},233:function(e,t,a){},238:function(e,t){},240:function(e,t){},251:function(e,t){},253:function(e,t){},280:function(e,t){},282:function(e,t){},283:function(e,t){},288:function(e,t){},290:function(e,t){},309:function(e,t){},32:function(e,t,a){e.exports={container:"styles_container__10YZe",background:"styles_background__2r9vj",chat_container:"styles_chat_container__2dSxz",contactListClickable:"styles_contactListClickable__2x0YA",chat_header:"styles_chat_header__2lwtE",chat_app_container:"styles_chat_app_container__hpWMz",chat_app_contactList_container:"styles_chat_app_contactList_container__1ZAt-",chat_app_contactList_contact:"styles_chat_app_contactList_contact__1Ek8z",chat_app_body:"styles_chat_app_body__3y5Fr",chat_app_msg_container:"styles_chat_app_msg_container__2XaNU",chat_app_contact:"styles_chat_app_contact__2mJq5",chat_app_msg_inMsg:"styles_chat_app_msg_inMsg__2V7Ef",chat_app_msg_outMsg:"styles_chat_app_msg_outMsg__4vvHT",chat_app_footer:"styles_chat_app_footer__2UMp1",msg_scrollbar:"styles_msg_scrollbar__2ODTw"}},321:function(e,t){},324:function(e,t){},348:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(42),s=a.n(c),r=(a(233),a(103)),l=a(22),i=a(18),u=a(19),p=a(21),m=a(20),_=(o.a.PureComponent,a(14)),g=a(57),d=a.n(g),f=a(411),h=a(409),y=a(408),v=a(407),b=a(414),E=a(418),S=a(416),O=a(417),j=a(405),N=a(111),k=a.n(N);function w(e){return JSON.stringify({coeff:e.coeff.toString(16),d:e.d.toString(16),dmp1:e.dmp1.toString(16),dmq1:e.dmq1.toString(16),e:e.e.toString(16),n:e.n.toString(16),p:e.p.toString(16),q:e.q.toString(16)})}function x(e,t){var a=e+t+"407e0fce8fcb1cee870e19575260b6f2";return k.a.generateRSAKey(a,1024)}var C=a(61),T=a.n(C),A=function(e){var t=e.open,a=e.setOpen,c=Object(n.useState)(""),s=Object(_.a)(c,2),r=s[0],l=s[1],i=Object(n.useState)(""),u=Object(_.a)(i,2),p=u[0],m=u[1],g=function(e){"username"==e.target.id&&l(e.target.value),"password"==e.target.id&&m(e.target.value)},d=function(){a(!1)};return o.a.createElement("div",null,o.a.createElement(b.a,{open:t,onClose:d},o.a.createElement(j.a,null,"Register"),o.a.createElement(S.a,null,o.a.createElement(O.a,null,"To register to this website, please enter your username and also password here."),o.a.createElement(v.a,{autoFocus:!0,margin:"normal",id:"username",label:"Username",type:"text",fullWidth:!0,variant:"standard",value:r,onChange:g}),o.a.createElement(v.a,{autoFocus:!0,margin:"normal",id:"password",label:"Password",type:"password",fullWidth:!0,variant:"standard",value:p,onChange:g})),o.a.createElement(E.a,null,o.a.createElement(y.a,{onClick:d},"Cancel"),o.a.createElement(y.a,{onClick:function(){var e,t=x(r,p),a=(e=t,k.a.publicKeyString(e)),n={username:r,password:p,public_key:a};T.a.ajax({method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(n),url:"/api/signup/",success:function(e,a){console.log(e),localStorage.setItem("SenderRSAkey",w(t)),localStorage.setItem("username",r),alert(e.msg)},error:function(e,t){console.log(e),alert(e.responseJSON.msg)}}),localStorage.setItem("SenderRSAkey",w(t)),localStorage.setItem("username",r)}},"Register"))))},L=function(){var e=Object(n.useState)(!1),t=Object(_.a)(e,2),a=t[0],c=t[1],s=Object(l.g)(),r=Object(n.useState)(""),i=Object(_.a)(r,2),u=i[0],p=i[1],m=Object(n.useState)(""),g=Object(_.a)(m,2),y=g[0],v=g[1],b=function(e){"username"==e.target.id&&p(e.target.value),"password"==e.target.id&&v(e.target.value)};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:d.a.container},o.a.createElement(A,{open:a,setOpen:c}),o.a.createElement("div",{className:d.a.background}),o.a.createElement("div",{className:d.a.content},o.a.createElement("div",{className:d.a.register,role:"button",onClick:function(){c(!0)}},"Register"),o.a.createElement(f.a,{className:d.a.form},o.a.createElement("h1",{className:d.a.heading},"Login"),o.a.createElement("div",{className:d.a.input},o.a.createElement("label",{htmlFor:"name"},"Login Name:"),o.a.createElement("input",{type:"text",name:"username",id:"username",autoComplete:"none",value:u,onChange:b})),o.a.createElement("div",{className:d.a.input},o.a.createElement("label",{htmlFor:"password"},"Password:"),o.a.createElement("input",{type:"password",name:"password",id:"password",value:y,onChange:b})),o.a.createElement("div",{className:d.a.submitContainer},o.a.createElement(h.a,{variant:"contained",onClick:function(){s.push("/chatpage");var e=x(u,y),t={username:u,password:y};localStorage.setItem("SenderRSAkey",w(e)),localStorage.setItem("username",u),T.a.ajax({method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t),url:"/api/login/",success:function(e,t){console.log(e)},error:function(e,t){console.log(e),alert("Invalid Username or Password.")}})}},"Login"))))))},R=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e){this.props.location.pathname!==e.location.pathname&&window.scrollTo(0,0)}},{key:"render",value:function(){return null}}]),a}(o.a.Component),I=a(32),J=a.n(I),P=a(413),F=a(206),M=a(207),q=a(72),K=a.n(q),U=a(141),H=a.n(U);function W(e){console.log(e);var t,a=K.a.utils.hex.toBytes(e.data.msg);t=e.data.to==localStorage.getItem("username")?e.data.msg_info:e.data.msg_info_for_sender;var n=JSON.parse(cryptico.decrypt(t.cipher,z).plaintext);console.log(t),console.log(n);var o=n.aes;console.log(o);var c=new K.a.ModeOfOperation.cbc(new Uint8Array(o.key_256.split(",")),new Uint8Array(o.iv.split(","))).decrypt(a),s=K.a.utils.utf8.fromBytes(c).slice(0,n.msg_length);return console.log(s),s}var B=a(212).a.connect("https://"+document.domain+":"+location.port),z=function(e){var t=JSON.parse(e),a=new N.RSAKey;return a.setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dmp1,t.dmq1,t.coeff),a}(localStorage.getItem("SenderRSAkey"));console.log(z);cryptico.publicKeyString(z);B.on("connect",(function(e){console.log(e),B.emit("join",{})})),B.on("all",(function(e){console.log(e)})),B.on("message",(function(e){W(e)}));var D=function(){var e=Object(n.useRef)(null),t=Object(n.useState)([]),a=Object(_.a)(t,2),c=a[0],s=(a[1],Object(n.useState)([])),r=Object(_.a)(s,2),l=r[0],i=r[1],u=localStorage.getItem("username"),p=Object(n.useState)(""),m=Object(_.a)(p,2),g=m[0],d=m[1],f=Object(n.useState)(0),h=Object(_.a)(f,2),y=h[0],v=h[1];return Object(n.useEffect)((function(){T.a.ajax({method:"GET",dataType:"json",contentType:"application/json",url:"/api/usernames/",success:function(e,t){console.log(e.usernames),i(e.usernames.filter((function(e){return e!=u})))},error:function(e,t){console.log(e)}})}),[]),Object(n.useEffect)((function(){l!==[]&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={target:e,start_message_index:t};T.a.ajax({method:"POST",dataType:"json",contentType:"application/json",headers:{"X-CSRF-TOKEN":H.a.get("csrf_access_token")},data:JSON.stringify(a),url:"/api/history/",success:function(e,t){console.log(e);for(var n=e.msgs,o=0;o<n.length;o++)n[o],Object(M.a)("data"),W(a)},error:function(e,t,a){console.log(e),console.log(t),console.log(a)}})}(l[y])}),[y]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:J.a.container},o.a.createElement("div",{className:J.a.background}),o.a.createElement("div",{className:J.a.chat_container},o.a.createElement("div",{className:J.a.chat_header},o.a.createElement("h1",null,"ChatPage")),o.a.createElement("div",{className:J.a.chat_app_container},o.a.createElement("div",{className:J.a.chat_app_contactList_container},l!==[]&&l.map((function(e,t){return o.a.createElement("li",{key:t,className:J.a.chat_app_contactList_contact,onClick:function(){return v(t)}},e)}))),o.a.createElement("div",{className:J.a.chat_app_body},o.a.createElement("div",{className:J.a.chat_app_contact},o.a.createElement("h2",null,l[y])),o.a.createElement("div",{className:J.a.chat_app_msg_container},o.a.createElement(F.Scrollbars,{ref:e,className:J.a.msg_scrollbar,universal:!0,autoHide:!0,autoHideTimeout:1e3,autoHideDuration:200},c!==[]&&c.map((function(e){return o.a.createElement("p",{className:e.isFromSelf?J.a.chat_app_msg_outMsg:J.a.chat_app_msg_inMsg},o.a.createElement("p",null,e.msg),o.a.createElement("span",null,e.time))})))),o.a.createElement("div",{className:J.a.chat_app_footer},o.a.createElement("input",{placeholder:" Enter message...",type:"text",value:g,onChange:function(e){d(e.target.value)}}),o.a.createElement("button",{onClick:function(){console.log("msg: "+g+"to: "+l[y]),function(e){var t={username:e};T.a.ajax({method:"POST",dataType:"text",contentType:"application/json",headers:{"X-CSRF-TOKEN":H.a.get("csrf_access_token")},data:JSON.stringify(t),url:"/public_keys/",success:function(e,t){console.log(e)},error:function(e,t,a){console.log(e),console.log(t),console.log(a)}})}(l[y])},type:"button"},o.a.createElement(P.a,null))))))))},X=a(211),Z=a.n(X),Q=a(97),Y=a.n(Q),G=(o.a.PureComponent,"/login"),V="/chatpage",$=function(){return o.a.createElement(r.a,null,o.a.createElement(R,null),o.a.createElement(l.d,null,o.a.createElement(l.b,{exact:!0,path:"/",component:L}),o.a.createElement(l.b,{exact:!0,path:G,component:L}),o.a.createElement(l.b,{exact:!0,path:V,component:D}),o.a.createElement(l.a,{from:"*",to:"/"})))};var ee=function(){return o.a.createElement($,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},57:function(e,t,a){e.exports={container:"styles_container__24Sv2",background:"styles_background__pxoan",content:"styles_content__2csTg",register:"styles_register__18u2K",form:"styles_form__2sLLb",heading:"styles_heading__2gQat",input:"styles_input__auRix",submitContainer:"styles_submitContainer__3SNv6"}},97:function(e,t,a){e.exports={App:"styles_App__36nvZ",AppLogo:"styles_AppLogo__10428",AppHeader:"styles_AppHeader__2rjvQ",AppLink:"styles_AppLink__2Kcaq"}}},[[228,1,2]]]);